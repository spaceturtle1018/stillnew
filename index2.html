<!DOCTYPE html>
<html>
<head>
    <title>ì˜¤ëŠ˜ì˜ ìš´ì„¸</title>
    <style>
        body { 
            font-family: Arial; 
            max-width: 600px; 
            margin: 50px auto; 
            padding: 20px;
        }
        .fortune-card, .stats-card { 
            background: #f0f0f0; 
            padding: 20px; 
            margin: 10px 0; 
            border-radius: 10px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stats-card {
            background: #e8f4f8;
            border-left: 4px solid #2196F3;
        }
        button { 
            background: #4CAF50; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #45a049;
        }
        #refreshStats {
            background: #2196F3;
        }
        #refreshStats:hover {
            background: #1976D2;
        }
        input {
            padding: 10px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 200px;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #ccc;
        }
        .stat-item:last-child {
            border-bottom: none;
        }
        .stat-value {
            font-weight: bold;
            color: #2196F3;
        }
    </style>
</head>
<body>
    <h1>ğŸ”® ì˜¤ëŠ˜ì˜ ìš´ì„¸</h1>
    
    <!-- ìš´ì„¸ ì…ë ¥ ì„¹ì…˜ -->
    <div style="text-align: center;">
        <input type="text" id="name" placeholder="ì´ë¦„" />
        <input type="date" id="birthdate" />
        <button onclick="getFortune()">ìš´ì„¸ ë³´ê¸°</button>
    </div>
    
    <!-- ìš´ì„¸ ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
    <div id="result"></div>
    
    <!-- í†µê³„ ì„¹ì…˜ -->
    <div class="stats-card">
        <div class="stats-header">
            <h3>ğŸ“Š ì„œë¹„ìŠ¤ í†µê³„</h3>
            <button id="refreshStats" onclick="getStats()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
        </div>
        <div id="stats">
            <div class="stat-item">
                <span>ë¡œë”© ì¤‘...</span>
            </div>
        </div>
    </div>
    
    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í†µê³„ ìë™ ë¡œë“œ
        window.onload = function() {
            getStats();
        };
        
        async function getFortune() {
            const name = document.getElementById('name').value;
            const birthdate = document.getElementById('birthdate').value;
            
            if (!name || !birthdate) {
                alert('ì´ë¦„ê³¼ ìƒë…„ì›”ì¼ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8000/api/fortune', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({name, birthdate})
                });
                
                const data = await response.json();
                document.getElementById('result').innerHTML = `
                    <div class="fortune-card">
                        <h2>${data.name}ë‹˜ì˜ ì˜¤ëŠ˜ ìš´ì„¸</h2>
                        <p>ğŸ“… ${data.date}</p>
                        <p>ğŸ’• ì—°ì• ìš´: ${data.love}</p>
                        <p>ğŸ’¼ ì§ì¥ìš´: ${data.career}</p>
                        <p>ğŸƒ ê±´ê°•ìš´: ${data.health}</p>
                        <p>ğŸ² í–‰ìš´ì˜ ìˆ«ì: <strong>${data.lucky_number}</strong></p>
                    </div>
                `;
                
                // ìš´ì„¸ë¥¼ ë³¸ í›„ í†µê³„ ìë™ ìƒˆë¡œê³ ì¹¨
                setTimeout(getStats, 500);
            } catch (error) {
                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                console.error('Error:', error);
            }
        }
        
        async function getStats() {
            try {
                const response = await fetch('http://localhost:8000/api/stats');
                const data = await response.json();
                
                const statsHtml = `
                    <div class="stat-item">
                        <span>ğŸ“ˆ ì „ì²´ ì¡°íšŒìˆ˜</span>
                        <span class="stat-value">${data.total_requests.toLocaleString()}íšŒ</span>
                    </div>
                    <div class="stat-item">
                        <span>ğŸ“† ì˜¤ëŠ˜ ì¡°íšŒìˆ˜</span>
                        <span class="stat-value">${data.today_requests}íšŒ</span>
                    </div>
                    <div class="stat-item">
                        <span>â° ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</span>
                        <span class="stat-value">${new Date().toLocaleTimeString()}</span>
                    </div>
                `;
                
                document.getElementById('stats').innerHTML = statsHtml;
                
                // ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
                const button = document.getElementById('refreshStats');
                button.style.transform = 'rotate(360deg)';
                button.style.transition = 'transform 0.5s';
                setTimeout(() => {
                    button.style.transform = 'rotate(0deg)';
                }, 500);
                
            } catch (error) {
                document.getElementById('stats').innerHTML = `
                    <div class="stat-item">
                        <span style="color: red;">í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>
                    </div>
                `;
                console.error('Stats Error:', error);
            }
        }
        
        // 10ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ í†µê³„ ìƒˆë¡œê³ ì¹¨ (ì„ íƒì‚¬í•­)
        setInterval(getStats, 10000);
    </script>
</body>
</html>
